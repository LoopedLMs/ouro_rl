{# Ouro chat template with enable_thinking support (PR pending upstream). #}
{# When enable_thinking=True, prepends <think>\n to trigger CoT reasoning. #}
{%- if messages[0]['role'] == 'system' -%}
    {{- '<|im_start|>system\n' + messages[0]['content'] + '<|im_end|>\n' }}
{%- else -%}
    {{- '<|im_start|>system\nYou are a helpful assistant.<|im_end|>\n' }}
{%- endif -%}
{%- for message in messages -%}
    {%- if message.role == 'system' and loop.first -%}
        {# Skip #}
    {%- else -%}
        {{- '<|im_start|>' + message['role'] + '\n' + message['content'] + '<|im_end|>' + '\n' }}
    {%- endif -%}
{%- endfor -%}
{%- if add_generation_prompt -%}
    {{- '<|im_start|>assistant\n' }}
    {%- if enable_thinking is defined and enable_thinking is true -%}
        {{- '<think>\n' }}
    {%- endif -%}
{%- endif -%}
